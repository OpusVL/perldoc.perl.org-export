      
      
      
      

      <!DOCTYPE html>
      <html lang="en">

      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="perlfaq6 - perldoc.perl.org">
        <link rel="icon" href="/public/img/favicon.ico">
        <title>perlfaq6 - perldoc.perl.org</title>
        <link href="/public/css/main.min.css" rel="stylesheet">
        <link rel="canonical" href="/perlfaq6.html">
        <link
          href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900'
          rel='stylesheet' type='text/css'>
        <script>
          window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments)
          };
          ga.l = +new Date;
          ga('create', 'UA-1892152-2', 'auto'); // JJ's account
          ga('create', 'UA-50555-3', 'auto', 'perlOrg'); // perl.org account
          ga('require', 'outboundLinkTracker', {
            events: ['click', 'auxclick', 'contextmenu'],
          });
          ga('require', 'maxScrollTracker');
          ga('send', 'pageview');
          ga('perlOrg.send', 'pageview');
        </script>
        <script async src="https://www.google-analytics.com/analytics.js">
        </script>
        <script async src="/public/js/tracking.min.js"></script>
      </head>

      <body class="body container-fluid ">
        <div class="wrapper">

          <nav
    class="navbar navbar-dark bg-primary bg-perl fixed-top justify-content-between navbar-expand-lg">
    <a href="#content" class="skippy sr-only sr-only-focusable">
        <span class=' skippy-text'>Skip to main content</span>
    </a>
    <a class="navbar-brand" href="/">
        <img class="logo" src="/public/img/logo_perl_doc.svg"
            alt="Perl Documentation Logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
        data-target="#navbar" aria-controls="navbar" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="collapse navbar-collapse ">
        <ul class="navbar-nav ml-auto navbar-right">
            <form class="nav-item dropdown search-wrapper">
                <input type="text" id='searchinput' aria-describedby='navbarDropdown5'
                    placeholder="Type query" class='search-input-field' value=''>

                <button href="#" data-toggle='dropdown' type="button"
                    aria-haspopup="true" aria-expanded='false' id="navbarDropdown5"
                    class="nav-link dropdown-toggle search-link">
                    <object tabindex='-1' focusable="false" class='search-icon'
                        data="/public/img/search.svg" type="image/svg+xml"
                        name='search icon'>search
                        icon</object>
                </button>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown5"
                    id='search-results'>
                    <p class='dropdown-item major-version'>
                        No results
                    </p>
                </div>
            </form>
            <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    
                        <p class='dropdown-item major-version'>
                            5.32
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.32.0/">5.32.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.30
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.30.3/">5.30.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.2/">5.30.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.1/">5.30.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.0/">5.30.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.28
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.28.3/">5.28.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.2/">5.28.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.1/">5.28.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.0/">5.28.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.26
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.26.3/">5.26.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.2/">5.26.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.1/">5.26.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.0/">5.26.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.24
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.24.4/">5.24.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.3/">5.24.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.2/">5.24.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.1/">5.24.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.0/">5.24.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.22
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.22.4/">5.22.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.3/">5.22.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.2/">5.22.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.1/">5.22.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.0/">5.22.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.20
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.20.3/">5.20.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.2/">5.20.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.1/">5.20.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.0/">5.20.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.18
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.18.4/">5.18.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.3/">5.18.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.2/">5.18.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.1/">5.18.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.0/">5.18.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.16
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.16.3/">5.16.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.2/">5.16.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.1/">5.16.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.0/">5.16.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.14
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.14.4/">5.14.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.3/">5.14.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.2/">5.14.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.1/">5.14.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.0/">5.14.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.12
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.12.5/">5.12.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.4/">5.12.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.3/">5.12.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.2/">5.12.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.1/">5.12.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.0/">5.12.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.10
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.10.1/">5.10.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.10.0/">5.10.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.8
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.8.9/">5.8.9</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.8/">5.8.8</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.7/">5.8.7</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.6/">5.8.6</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.5/">5.8.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.4/">5.8.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.3/">5.8.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.2/">5.8.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.1/">5.8.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.0/">5.8.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.6
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.6.2/">5.6.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.1/">5.6.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.0/">5.6.0</a>
                        
                        
                    
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                    <a class="dropdown-item"
                        href="/5.20.2/index-overview.html">Overview</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-tutorials.html">Tutorials</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-faq.html">FAQs</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-history.html">Changes</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-licence.html">License</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-language.html">Language</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-functions.html">Functions</a>
                    <a class="dropdown-item"
                        href="/5.20.2/perlop.html">Operators</a>
                    <a class="dropdown-item"
                        href="/5.20.2/perlvar.html">Variables</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-pragmas.html">Pragmas</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-utilities.html">Utilities</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-internals.html">Internals</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-platforms.html">Platforms</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3"
                    class="dropdown-menu letters-wrap">
                    <!--<a class="dropdown-item"
                        href="/5.20.2/index-modules.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-modules-by-cat.html">By
                        Category</a>-->
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-A.html">A</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-B.html">B</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-C.html">C</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-D.html">D</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-E.html">E</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-F.html">F</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-G.html">G</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-H.html">H</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-I.html">I</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-J.html">J</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-K.html">K</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-L.html">L</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-M.html">M</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-N.html">N</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-O.html">O</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-P.html">P</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-Q.html">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-R.html">R</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-S.html">S</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-T.html">T</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-U.html">U</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-V.html">V</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-W.html">W</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-X.html">X</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-Y.html">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-modules-Z.html">Z</a>
                    </div>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown4" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Functions</a>
                <div aria-labelledby="navbarDropdown4"
                    class="dropdown-menu letters-wrap">
                    <a class="dropdown-item"
                        href="/5.20.2/index-functions.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.20.2/index-functions-by-cat.html">By
                        Category</a>
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#A">A</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#B">B</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#C">C</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#D">D</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#E">E</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#F">F</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#G">G</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#H">H</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#I">I</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#J">J</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#K">K</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#L">L</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#M">M</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#N">N</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#O">O</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#P">P</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#Q">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#R">R</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#S">S</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#T">T</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#U">U</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#V">V</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#W">W</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#X">X</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#Y">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.20.2/index-functions.html#Z">Z</a>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <!--/.nav-collapse -->
</nav>


          <main class="row main-content pb-5 pt-5" id='content'>
            <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
              <div class="row">
                <div class="col-sm-12">
                  <div id="breadcrumbs">
                      
    <a href="index.html">Home</a>&nbsp; &gt;
    
      
        <a href="index-faq.html">FAQs</a> &gt;
      
    
    perlfaq6
  

                  </div>
                </div>
              </div>
              <div class="row">
                <article class="col-sm-12 content">
                  <div class="documentation-wrapper">
                    <div id="perl_version">
                      <h7 class='page-title'> Perl 5 version 20.2
                        documentation</h7>
                    </div>
                    <h1>perlfaq6</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><ul><li><a href="#How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code%3f">How can I hope to use regular expressions without creating illegible and unmaintainable code?
 
 </a></li><li><a href="#I'm-having-trouble-matching-over-more-than-one-line.-What's-wrong%3f">I'm having trouble matching over more than one line. What's wrong?
  </a></li><li><a href="#How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines%3f">How can I pull out lines between two patterns that are themselves on different lines?
</a></li><li><a href="#How-do-I-match-XML%2c-HTML%2c-or-other-nasty%2c-ugly-things-with-a-regex%3f">How do I match XML, HTML, or other nasty, ugly things with a regex?
     
</a></li><li><a href="#I-put-a-regular-expression-into-%24%2f-but-it-didn't-work.-What's-wrong%3f">I put a regular expression into $/ but it didn't work. What's wrong?
 
</a></li><li><a href="#How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS%3f">How do I substitute case-insensitively on the LHS while preserving case on the RHS?
 
 </a></li><li><a href="#How-can-I-make-%5cw-match-national-character-sets%3f">How can I make \w match national character sets?
</a></li><li><a href="#How-can-I-match-a-locale-smart-version-of-%2f%5ba-zA-Z%5d%2f%3f">How can I match a locale-smart version of /[a-zA-Z]/?
</a></li><li><a href="#How-can-I-quote-a-variable-to-use-in-a-regex%3f">How can I quote a variable to use in a regex?
  </a></li><li><a href="#What-is-%2fo-really-for%3f">What is /o really for?
 </a></li><li><a href="#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file%3f">How do I use a regular expression to strip C-style comments from a file?</a></li><li><a href="#Can-I-use-Perl-regular-expressions-to-match-balanced-text%3f">Can I use Perl regular expressions to match balanced text?
 
  
   </a></li><li><a href="#What-does-it-mean-that-regexes-are-greedy%3f-How-can-I-get-around-it%3f">What does it mean that regexes are greedy? How can I get around it?
 </a></li><li><a href="#How-do-I-process-each-word-on-each-line%3f">How do I process each word on each line?
</a></li><li><a href="#How-can-I-print-out-a-word-frequency-or-line-frequency-summary%3f">How can I print out a word-frequency or line-frequency summary?</a></li><li><a href="#How-can-I-do-approximate-matching%3f">How can I do approximate matching?
 </a></li><li><a href="#How-do-I-efficiently-match-many-regular-expressions-at-once%3f">How do I efficiently match many regular expressions at once?
 
</a></li><li><a href="#Why-don't-word-boundary-searches-with-%5cb-work-for-me%3f">Why don't word-boundary searches with \b work for me?
</a></li><li><a href="#Why-does-using-%24%26%2c-%24%60%2c-or-%24'-slow-my-program-down%3f">Why does using $&, $`, or $' slow my program down?
     </a></li><li><a href="#What-good-is-%5cG-in-a-regular-expression%3f">What good is \G in a regular expression?
</a></li><li><a href="#Are-Perl-regexes-DFAs-or-NFAs%3f-Are-they-POSIX-compliant%3f">Are Perl regexes DFAs or NFAs? Are they POSIX compliant?
  </a></li><li><a href="#What's-wrong-with-using-grep-in-a-void-context%3f">What's wrong with using grep in a void context?
</a></li><li><a href="#How-can-I-match-strings-with-multibyte-characters%3f">How can I match strings with multibyte characters?
 
  </a></li><li><a href="#How-do-I-match-a-regular-expression-that's-in-a-variable%3f">How do I match a regular expression that's in a variable?
    
 </a></li></ul><li><a href="#AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</a></li></ul><a class='view-head1' id="NAME"></a><h2 class='h2' >NAME</h2>
<p>perlfaq6 - Regular Expressions</p>
<a class='view-head1' id="DESCRIPTION"></a><h2 class='h2' >DESCRIPTION</h2>
<p>This section is surprisingly small because the rest of the FAQ is
littered with answers involving regular expressions. For example,
decoding a URL and checking whether something is a number can be handled
with regular expressions, but those answers are found elsewhere in
this document (in <a href="perlfaq9.html">perlfaq9</a>: "How do I decode or create those %-encodings
on the web" and <a href="perlfaq4.html">perlfaq4</a>: "How do I determine whether a scalar is
a number/whole/integer/float", to be precise).</p>
<a class='view-head2' id="How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code%3f"></a><h3 class='h3' >How can I hope to use regular expressions without creating illegible and unmaintainable code?
 
 </h3>
<p>Three techniques can make regular expressions maintainable and
understandable.</p>
<ul>
<li><a class='view-title' id="Comments-Outside-the-Regex"></a><strong>Comments Outside the Regex</strong>
<p>Describe what you're doing and how you're doing it, using normal Perl
comments.</p>
<pre class="verbatim"><ol><li>    <span class="c"># turn the line into the first word, a colon, and the</span></li><li>    <span class="c"># number of characters on the rest of the line</span></li><li>    <span class="q">s/^(\w+)(.*)/ lc($1) . &quot;:&quot; . length($2) /meg</span><span class="sc">;</span></li></ol></pre></li>
<li><a class='view-title' id="Comments-Inside-the-Regex"></a><strong>Comments Inside the Regex</strong>
<p>The <code class="inline"><span class="q">/x</span></code>
 modifier causes whitespace to be ignored in a regex pattern
(except in a character class and a few other places), and also allows you to
use normal comments there, too. As you can imagine, whitespace and comments
help a lot.</p>
<p><code class="inline"><span class="q">/x</span></code>
 lets you turn this:</p>
<pre class="verbatim"><ol><li>    <span class="q">s{&lt;(?:[^&gt;&#39;&quot;]*|&quot;.*?&quot;|&#39;.*?&#39;)+&gt;}{}gs</span><span class="sc">;</span></li></ol></pre><p>into this:</p>
<pre class="verbatim"><ol><li>    <span class="q">s{ &lt;                    # opening angle bracket</span></li><li>        <span class="q">        (?:                 # Non-backreffing grouping paren</span></li><li>            <span class="q">            [^&gt;&#39;&quot;] *        # 0 or more things that are neither &gt; nor &#39; nor &quot;</span></li><li>                <span class="q">                |           #    or else</span></li><li>            <span class="q">            &quot;.*?&quot;           # a section between double quotes (stingy match)</span></li><li>                <span class="q">                |           #    or else</span></li><li>            <span class="q">            &#39;.*?&#39;           # a section between single quotes (stingy match)</span></li><li>        <span class="q">        ) +                 #   all occurring one or more times</span></li><li>        <span class="q">        &gt;                   # closing angle bracket</span></li><li>    <span class="q">    }{}gsx</span><span class="sc">;</span>                 <span class="c"># replace with nothing, i.e. delete</span></li></ol></pre><p>It's still not quite so clear as prose, but it is very useful for
describing the meaning of each part of the pattern.</p>
</li>
<li><a class='view-title' id="Different-Delimiters"></a><strong>Different Delimiters</strong>
<p>While we normally think of patterns as being delimited with <code class="inline"><span class="q">/</span></code>

characters, they can be delimited by almost any character. <a href="perlre.html">perlre</a>
describes this. For example, the <code class="inline"><a class="l_k" href="functions/s.html">s///</a></code> above uses braces as
delimiters. Selecting another delimiter can avoid quoting the
delimiter within the pattern:</p>
<pre class="verbatim"><ol><li>    <span class="q">s/\/usr\/local/\/usr\/share/g</span><span class="sc">;</span>    <span class="c"># bad delimiter choice</span></li><li>    <span class="q">s#/usr/local#/usr/share#g</span><span class="sc">;</span>        <span class="c"># better</span></li></ol></pre><p>Using logically paired delimiters can be even more readable:</p>
<pre class="verbatim"><ol><li>    <span class="q">s{/usr/local/}{/usr/share}g</span><span class="sc">;</span>      <span class="c"># better still</span></li></ol></pre></li>
</ul>
<a class='view-head2' id="I'm-having-trouble-matching-over-more-than-one-line.-What's-wrong%3f"></a><h3 class='h3' >I'm having trouble matching over more than one line. What's wrong?
  </h3>
<p>Either you don't have more than one line in the string you're looking
at (probably), or else you aren't using the correct modifier(s) on
your pattern (possibly).</p>
<p>There are many ways to get multiline data into a string. If you want
it to happen automatically while reading input, you'll want to set $/
(probably to '' for paragraphs or <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> for the whole file) to
allow you to read more than one line at a time.</p>
<p>Read <a href="perlre.html">perlre</a> to help you decide which of <code class="inline"><span class="q">/s</span></code>
 and <code class="inline"><span class="q">/m</span></code>
 (or both)
you might want to use: <code class="inline"><span class="q">/s</span></code>
 allows dot to include newline, and <code class="inline"><span class="q">/m</span></code>

allows caret and dollar to match next to a newline, not just at the
end of the string. You do need to make sure that you've actually
got a multiline string in there.</p>
<p>For example, this program detects duplicate words, even when they span
line breaks (but not paragraph ones). For this example, we don't need
<code class="inline"><span class="q">/s</span></code>
 because we aren't using dot in a regular expression that we want
to cross line boundaries. Neither do we need <code class="inline"><span class="q">/m</span></code>
 because we don't
want caret or dollar to match at any point inside the record next
to newlines. But it's imperative that $/ be set to something other
than the default, or else we won't actually ever have a multiline
record read in.</p>
<pre class="verbatim"><ol><li>    <span class="i">$/</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>          <span class="c"># read in whole paragraph, not just one line</span></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <span class="q">/\b([\w&#39;-]+)(\s+\g1)+\b/gi</span> <span class="s">)</span> <span class="s">{</span>     <span class="c"># word starts alpha</span></li><li>            <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Duplicate $1 at paragraph $.\n&quot;</span><span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>Here's some code that finds sentences that begin with "From " (which would
be mangled by many mailers):</p>
<pre class="verbatim"><ol><li>    <span class="i">$/</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>          <span class="c"># read in whole paragraph, not just one line</span></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <span class="q">/^From /gm</span> <span class="s">)</span> <span class="s">{</span> <span class="c"># /m makes ^ match next to \n</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;leading from in paragraph $.\n&quot;</span><span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>Here's code that finds everything between START and END in a paragraph:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/undef.html">undef</a> <span class="i">$/</span><span class="sc">;</span>          <span class="c"># read in whole file, not just one line or paragraph</span></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <span class="q">/START(.*?)END/sgm</span> <span class="s">)</span> <span class="s">{</span> <span class="c"># /s makes . cross line boundaries</span></li><li>            <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$1\n&quot;</span><span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines%3f"></a><h3 class='h3' >How can I pull out lines between two patterns that are themselves on different lines?
</h3>
<p>You can use Perl's somewhat exotic <code class="inline">..</code>
 operator (documented in
<a href="perlop.html">perlop</a>):</p>
<pre class="verbatim"><ol><li>    <span class="w">perl</span> -<a class="l_k" href="functions/ne.html">ne</a> <span class="q">&#39;print if /START/ .. /END/&#39;</span> <span class="w">file1</span> <span class="w">file2</span> ...</li></ol></pre><p>If you wanted text and not lines, you would use</p>
<pre class="verbatim"><ol><li>    <span class="w">perl</span> -<span class="n">0777</span> -<a class="l_k" href="functions/ne.html">ne</a> <span class="q">&#39;print &quot;$1\n&quot; while /START(.*?)END/gs&#39;</span> <span class="w">file1</span> <span class="w">file2</span> ...</li></ol></pre><p>But if you want nested occurrences of <code class="inline"><span class="w">START</span></code>
 through <code class="inline"><a class="l_k" href="functions/END.html">END</a></code>, you'll
run up against the problem described in the question in this section
on matching balanced text.</p>
<p>Here's another example of using <code class="inline">..</code>
:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="i">$in_header</span> =   <span class="n">1</span>  .. <span class="q">/^$/</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="i">$in_body</span>   = <span class="q">/^$/</span> .. <a class="l_k" href="functions/eof.html">eof</a><span class="sc">;</span></li><li>    <span class="c"># now choose between them</span></li><li>    <span class="s">}</span> <a class="l_k" href="functions/continue.html">continue</a> <span class="s">{</span></li><li>        <span class="i">$.</span> = <span class="n">0</span> <a class="l_k" href="functions/if.html">if</a> <a class="l_k" href="functions/eof.html">eof</a><span class="sc">;</span>    <span class="c"># fix $.</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-do-I-match-XML%2c-HTML%2c-or-other-nasty%2c-ugly-things-with-a-regex%3f"></a><h3 class='h3' >How do I match XML, HTML, or other nasty, ugly things with a regex?
     
</h3>
<p>Do not use regexes. Use a module and forget about the
regular expressions. The <a href="https://search.cpan.org/perldoc/XML::LibXML">XML::LibXML</a>, <a href="https://search.cpan.org/perldoc/HTML::TokeParser">HTML::TokeParser</a> and
<a href="https://search.cpan.org/perldoc/HTML::TreeBuilder">HTML::TreeBuilder</a> modules are good starts, although each namespace
has other parsing modules specialized for certain tasks and different
ways of doing it. Start at CPAN Search ( <a href="http://metacpan.org/">http://metacpan.org/</a> )
and wonder at all the work people have done for you already! :)</p>
<a class='view-head2' id="I-put-a-regular-expression-into-%24%2f-but-it-didn't-work.-What's-wrong%3f"></a><h3 class='h3' >I put a regular expression into $/ but it didn't work. What's wrong?
 
</h3>
<p>$/ has to be a string. You can use these examples if you really need to
do this.</p>
<p>If you have <a href="https://search.cpan.org/perldoc/File::Stream">File::Stream</a>, this is easy.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">File::Stream</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$stream</span> = <span class="w">File::Stream</span><span class="w">-&gt;new</span><span class="s">(</span></li><li>        <span class="i">$filehandle</span><span class="cm">,</span></li><li>        <span class="w">separator</span> <span class="cm">=&gt;</span> <span class="q">qr/\s*,\s*/</span><span class="cm">,</span></li><li>        <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$_\n&quot;</span> <a class="l_k" href="functions/while.html">while</a> <span class="q">&lt;$stream&gt;</span><span class="sc">;</span></li></ol></pre><p>If you don't have File::Stream, you have to do a little more work.</p>
<p>You can use the four-argument form of sysread to continually add to
a buffer. After you add to the buffer, you check if you have a
complete line (using your regular expression).</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/local.html">local</a> <span class="i">$_</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <a class="l_k" href="functions/sysread.html">sysread</a> <span class="w">FH</span><span class="cm">,</span> <span class="i">$_</span><span class="cm">,</span> <span class="n">8192</span><span class="cm">,</span> <a class="l_k" href="functions/length.html">length</a> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <span class="q">s/^((?s).*?)your_pattern//</span> <span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/my.html">my</a> <span class="i">$record</span> = <span class="i">$1</span><span class="sc">;</span></li><li>            <span class="c"># do stuff here.</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>You can do the same thing with foreach and a match using the
c flag and the \G anchor, if you do not mind your entire file
being in memory at the end.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/local.html">local</a> <span class="i">$_</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <a class="l_k" href="functions/sysread.html">sysread</a> <span class="w">FH</span><span class="cm">,</span> <span class="i">$_</span><span class="cm">,</span> <span class="n">8192</span><span class="cm">,</span> <a class="l_k" href="functions/length.html">length</a> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/foreach.html">foreach</a> <a class="l_k" href="functions/my.html">my</a> <span class="i">$record</span> <span class="s">(</span> <span class="q">m/\G((?s).*?)your_pattern/gc</span> <span class="s">)</span> <span class="s">{</span></li><li>            <span class="c"># do stuff here.</span></li><li>        <span class="s">}</span></li><li>        <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span> <span class="i">$_</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <a class="l_k" href="functions/pos.html">pos</a> <span class="s">)</span> = <span class="q">&quot;&quot;</span> <a class="l_k" href="functions/if.html">if</a> <a class="l_k" href="functions/pos.html">pos</a><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS%3f"></a><h3 class='h3' >How do I substitute case-insensitively on the LHS while preserving case on the RHS?
 
 </h3>
<p>Here's a lovely Perlish solution by Larry Rosler. It exploits
properties of bitwise xor on ASCII strings.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span>= <span class="q">&quot;this is a TEsT case&quot;</span><span class="sc">;</span></li><li></li><li>    <span class="i">$old</span> = <span class="q">&#39;test&#39;</span><span class="sc">;</span></li><li>    <span class="i">$new</span> = <span class="q">&#39;success&#39;</span><span class="sc">;</span></li><li></li><li>    <span class="q">s{(\Q$old\E)}</span></li><li>    <span class="q">    { uc $new | (uc $1 ^ $1) .</span></li><li>        <span class="q">        (uc(substr $1, -1) ^ substr $1, -1) x</span></li><li>        <span class="q">        (length($new) - length $1)</span></li><li>    <span class="q">    }egi</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a><span class="sc">;</span></li></ol></pre><p>And here it is as a subroutine, modeled after the above:</p>
<pre class="verbatim"><ol><li><a name="preserve_case"></a>    sub <span class="m">preserve_case</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$old</span><span class="cm">,</span> <span class="i">$new</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="i">$mask</span> = <a class="l_k" href="functions/uc.html">uc</a> <span class="i">$old</span> ^ <span class="i">$old</span><span class="sc">;</span></li><li></li><li>        <a class="l_k" href="functions/uc.html">uc</a> <span class="i">$new</span> | <span class="i">$mask</span> .</li><li>            <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$mask</span><span class="cm">,</span> <span class="n">-1</span><span class="s">)</span> x <span class="s">(</span><a class="l_k" href="functions/length.html">length</a><span class="s">(</span><span class="i">$new</span><span class="s">)</span> - <a class="l_k" href="functions/length.html">length</a><span class="s">(</span><span class="i">$old</span><span class="s">)</span><span class="s">)</span></li><li>    <span class="s">}</span></li><li></li><li>    <span class="i">$string</span> = <span class="q">&quot;this is a TEsT case&quot;</span><span class="sc">;</span></li><li>    <span class="i">$string</span> =~ <span class="q">s/(test)/preserve_case($1, &quot;success&quot;)/egi</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$string\n&quot;</span><span class="sc">;</span></li></ol></pre><p>This prints:</p>
<pre class="verbatim"><ol><li>    <span class="w">this</span> <span class="w">is</span> <span class="w">a</span> <span class="w">SUcCESS</span> case</li></ol></pre><p>As an alternative, to keep the case of the replacement word if it is
longer than the original, you can use this code, by Jeff Pinyan:</p>
<pre class="verbatim"><ol><li><a name="preserve_case"></a>    sub <span class="m">preserve_case</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$from</span><span class="cm">,</span> <span class="i">$to</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$lf</span><span class="cm">,</span> <span class="i">$lt</span><span class="s">)</span> = <a class="l_k" href="functions/map.html">map</a> <a class="l_k" href="functions/length.html">length</a><span class="cm">,</span> <span class="i">@_</span><span class="sc">;</span></li><li></li><li>        <a class="l_k" href="functions/if.html">if</a> <span class="s">(</span><span class="i">$lt</span> &lt; <span class="i">$lf</span><span class="s">)</span> <span class="s">{</span> <span class="i">$from</span> = <a class="l_k" href="functions/substr.html">substr</a> <span class="i">$from</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$lt</span> <span class="s">}</span></li><li>        <a class="l_k" href="functions/else.html">else</a> <span class="s">{</span> <span class="i">$from</span> .= <a class="l_k" href="functions/substr.html">substr</a> <span class="i">$to</span><span class="cm">,</span> <span class="i">$lf</span> <span class="s">}</span></li><li></li><li>        <a class="l_k" href="functions/return.html">return</a> <a class="l_k" href="functions/uc.html">uc</a> <span class="i">$to</span> | <span class="s">(</span><span class="i">$from</span> ^ <a class="l_k" href="functions/uc.html">uc</a> <span class="i">$from</span><span class="s">)</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>This changes the sentence to "this is a SUcCess case."</p>
<p>Just to show that C programmers can write C in any programming language,
if you prefer a more C-like solution, the following script makes the
substitution have the same case, letter by letter, as the original.
(It also happens to run about 240% slower than the Perlish solution runs.)
If the substitution has more characters than the string being substituted,
the case of the last character is used for the rest of the substitution.</p>
<pre class="verbatim"><ol><li>    <span class="c"># Original by Nathan Torkington, massaged by Jeffrey Friedl</span></li><li>    <span class="c">#</span></li><li><a name="preserve_case"></a>    sub <span class="m">preserve_case</span></li><li>    <span class="s">{</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$old</span><span class="cm">,</span> <span class="i">$new</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="i">$state</span> = <span class="n">0</span><span class="sc">;</span> <span class="c"># 0 = no change; 1 = lc; 2 = uc</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$i</span><span class="cm">,</span> <span class="i">$oldlen</span><span class="cm">,</span> <span class="i">$newlen</span><span class="cm">,</span> <span class="i">$c</span><span class="s">)</span> = <span class="s">(</span><span class="n">0</span><span class="cm">,</span> <a class="l_k" href="functions/length.html">length</a><span class="s">(</span><span class="i">$old</span><span class="s">)</span><span class="cm">,</span> <a class="l_k" href="functions/length.html">length</a><span class="s">(</span><span class="i">$new</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/my.html">my</a> <span class="i">$len</span> = <span class="i">$oldlen</span> &lt; <span class="i">$newlen</span> ? <span class="i">$oldlen</span> <span class="co">:</span> <span class="i">$newlen</span><span class="sc">;</span></li><li></li><li>        <a class="l_k" href="functions/for.html">for</a> <span class="s">(</span><span class="i">$i</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$i</span> &lt; <span class="i">$len</span><span class="sc">;</span> <span class="i">$i</span>++<span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/if.html">if</a> <span class="s">(</span><span class="i">$c</span> = <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$old</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span><span class="cm">,</span> <span class="i">$c</span> =~ <span class="q">/[\W\d_]/</span><span class="s">)</span> <span class="s">{</span></li><li>                <span class="i">$state</span> = <span class="n">0</span><span class="sc">;</span></li><li>            <span class="s">}</span> <a class="l_k" href="functions/elsif.html">elsif</a> <span class="s">(</span><a class="l_k" href="functions/lc.html">lc</a> <span class="i">$c</span> <a class="l_k" href="functions/eq.html">eq</a> <span class="i">$c</span><span class="s">)</span> <span class="s">{</span></li><li>                <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span> = <a class="l_k" href="functions/lc.html">lc</a><span class="s">(</span><a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></li><li>                <span class="i">$state</span> = <span class="n">1</span><span class="sc">;</span></li><li>            <span class="s">}</span> <a class="l_k" href="functions/else.html">else</a> <span class="s">{</span></li><li>                <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span> = <a class="l_k" href="functions/uc.html">uc</a><span class="s">(</span><a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></li><li>                <span class="i">$state</span> = <span class="n">2</span><span class="sc">;</span></li><li>            <span class="s">}</span></li><li>        <span class="s">}</span></li><li>        <span class="c"># finish up with any remaining new (for when new is longer than old)</span></li><li>        <a class="l_k" href="functions/if.html">if</a> <span class="s">(</span><span class="i">$newlen</span> &gt; <span class="i">$oldlen</span><span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/if.html">if</a> <span class="s">(</span><span class="i">$state</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span></li><li>                <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$oldlen</span><span class="s">)</span> = <a class="l_k" href="functions/lc.html">lc</a><span class="s">(</span><a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$oldlen</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></li><li>            <span class="s">}</span> <a class="l_k" href="functions/elsif.html">elsif</a> <span class="s">(</span><span class="i">$state</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span></li><li>                <a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$oldlen</span><span class="s">)</span> = <a class="l_k" href="functions/uc.html">uc</a><span class="s">(</span><a class="l_k" href="functions/substr.html">substr</a><span class="s">(</span><span class="i">$new</span><span class="cm">,</span> <span class="i">$oldlen</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></li><li>            <span class="s">}</span></li><li>        <span class="s">}</span></li><li>        <a class="l_k" href="functions/return.html">return</a> <span class="i">$new</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-can-I-make-%5cw-match-national-character-sets%3f"></a><h3 class='h3' >How can I make <code class="inline">\<span class="w">w</span></code>
 match national character sets?
</h3>
<p>Put <code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="w">locale</span><span class="sc">;</span></code>
 in your script. The \w character class is taken
from the current locale.</p>
<p>See <a href="perllocale.html">perllocale</a> for details.</p>
<a class='view-head2' id="How-can-I-match-a-locale-smart-version-of-%2f%5ba-zA-Z%5d%2f%3f"></a><h3 class='h3' >How can I match a locale-smart version of <code class="inline"><span class="q">/[a-zA-Z]/</span></code>
?
</h3>
<p>You can use the POSIX character class syntax <code class="inline"><span class="q">/[[:alpha:]]/</span></code>

documented in <a href="perlre.html">perlre</a>.</p>
<p>No matter which locale you are in, the alphabetic characters are
the characters in \w without the digits and the underscore.
As a regex, that looks like <code class="inline"><span class="q">/[^\W\d_]/</span></code>
. Its complement,
the non-alphabetics, is then everything in \W along with
the digits and the underscore, or <code class="inline"><span class="q">/[\W\d_]/</span></code>
.</p>
<a class='view-head2' id="How-can-I-quote-a-variable-to-use-in-a-regex%3f"></a><h3 class='h3' >How can I quote a variable to use in a regex?
  </h3>
<p>The Perl parser will expand $variable and @variable references in
regular expressions unless the delimiter is a single quote. Remember,
too, that the right-hand side of a <code class="inline"><a class="l_k" href="functions/s.html">s///</a></code> substitution is considered
a double-quoted string (see <a href="perlop.html">perlop</a> for more details). Remember
also that any regex special characters will be acted on unless you
precede the substitution with \Q. Here's an example:</p>
<pre class="verbatim"><ol><li>    <span class="i">$string</span> = <span class="q">&quot;Placido P. Octopus&quot;</span><span class="sc">;</span></li><li>    <span class="i">$regex</span>  = <span class="q">&quot;P.&quot;</span><span class="sc">;</span></li><li></li><li>    <span class="i">$string</span> =~ <span class="q">s/$regex/Polyp/</span><span class="sc">;</span></li><li>    <span class="c"># $string is now &quot;Polypacido P. Octopus&quot;</span></li></ol></pre><p>Because <code class="inline">.</code>
 is special in regular expressions, and can match any
single character, the regex <code class="inline"><span class="w">P</span>.</code>
 here has matched the &lt;Pl&gt; in the
original string.</p>
<p>To escape the special meaning of <code class="inline">.</code>
, we use <code class="inline">\<span class="w">Q</span></code>
:</p>
<pre class="verbatim"><ol><li>    <span class="i">$string</span> = <span class="q">&quot;Placido P. Octopus&quot;</span><span class="sc">;</span></li><li>    <span class="i">$regex</span>  = <span class="q">&quot;P.&quot;</span><span class="sc">;</span></li><li></li><li>    <span class="i">$string</span> =~ <span class="q">s/\Q$regex/Polyp/</span><span class="sc">;</span></li><li>    <span class="c"># $string is now &quot;Placido Polyp Octopus&quot;</span></li></ol></pre><p>The use of <code class="inline">\<span class="w">Q</span></code>
 causes the &lt;.&gt; in the regex to be treated as a
regular character, so that <code class="inline"><span class="w">P</span>.</code>
 matches a <code class="inline"><span class="w">P</span></code>
 followed by a dot.</p>
<a class='view-head2' id="What-is-%2fo-really-for%3f"></a><h3 class='h3' >What is <code class="inline"><span class="q">/o</span></code>
 really for?
 </h3>
<p>(contributed by brian d foy)</p>
<p>The <code class="inline"><span class="q">/o</span></code>
 option for regular expressions (documented in <a href="perlop.html">perlop</a> and
<a href="perlreref.html">perlreref</a>) tells Perl to compile the regular expression only once.
This is only useful when the pattern contains a variable. Perls 5.6
and later handle this automatically if the pattern does not change.</p>
<p>Since the match operator <code class="inline"><a class="l_k" href="functions/m.html">m//</a></code>, the substitution operator <code class="inline"><a class="l_k" href="functions/s.html">s///</a></code>,
and the regular expression quoting operator <code class="inline"><a class="l_k" href="functions/qr.html">qr//</a></code> are double-quotish
constructs, you can interpolate variables into the pattern. See the
answer to "How can I quote a variable to use in a regex?" for more
details.</p>
<p>This example takes a regular expression from the argument list and
prints the lines of input that match it:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$pattern</span> = <a class="l_k" href="functions/shift.html">shift</a> <span class="i">@ARGV</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/if.html">if</a> <span class="q">m/$pattern/</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>Versions of Perl prior to 5.6 would recompile the regular expression
for each iteration, even if <code class="inline"><span class="i">$pattern</span></code>
 had not changed. The <code class="inline"><span class="q">/o</span></code>

would prevent this by telling Perl to compile the pattern the first
time, then reuse that for subsequent iterations:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$pattern</span> = <a class="l_k" href="functions/shift.html">shift</a> <span class="i">@ARGV</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/if.html">if</a> <span class="q">m/$pattern/o</span><span class="sc">;</span> <span class="c"># useful for Perl &lt; 5.6</span></li><li>    <span class="s">}</span></li></ol></pre><p>In versions 5.6 and later, Perl won't recompile the regular expression
if the variable hasn't changed, so you probably don't need the <code class="inline"><span class="q">/o</span></code>

option. It doesn't hurt, but it doesn't help either. If you want any
version of Perl to compile the regular expression only once even if
the variable changes (thus, only using its initial value), you still
need the <code class="inline"><span class="q">/o</span></code>
.</p>
<p>You can watch Perl's regular expression engine at work to verify for
yourself if Perl is recompiling a regular expression. The <code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="w">re</span>
<span class="q">&#39;debug&#39;</span></code>
 pragma (comes with Perl 5.005 and later) shows the details.
With Perls before 5.6, you should see <code class="inline"><span class="w">re</span></code>
 reporting that its
compiling the regular expression on each iteration. With Perl 5.6 or
later, you should only see <code class="inline"><span class="w">re</span></code>
 report that for the first iteration.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">re</span> <span class="q">&#39;debug&#39;</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">&#39;Perl&#39;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/foreach.html">foreach</a> <span class="s">(</span> <span class="q">qw(Perl Java Ruby Python)</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="i">STDERR</span> <span class="q">&quot;-&quot;</span> x <span class="n">73</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="i">STDERR</span> <span class="q">&quot;Trying $_...\n&quot;</span><span class="sc">;</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="i">STDERR</span> <span class="q">&quot;\t$_ is good!\n&quot;</span> <a class="l_k" href="functions/if.html">if</a> <span class="q">m/$regex/</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file%3f"></a><h3 class='h3' >How do I use a regular expression to strip C-style comments from a file?</h3>
<p>While this actually can be done, it's much harder than you'd think.
For example, this one-liner</p>
<pre class="verbatim"><ol><li>    <span class="w">perl</span> -<span class="n">0777</span> -<span class="w">pe</span> <span class="q">&#39;s{/\*.*?\*/}{}gs&#39;</span> <span class="w">foo</span>.<span class="w">c</span></li></ol></pre><p>will work in many but not all cases. You see, it's too simple-minded for
certain kinds of C programs, in particular, those with what appear to be
comments in quoted strings. For that, you'd need something like this,
created by Jeffrey Friedl and later modified by Fred Curtis.</p>
<pre class="verbatim"><ol><li>    <span class="i">$/</span> = <a class="l_k" href="functions/undef.html">undef</a><span class="sc">;</span></li><li>    <span class="i">$_</span> = &lt;&gt;<span class="sc">;</span></li><li>    <span class="q">s#/\*[^*]*\*+([^/*][^*]*\*+)*/|(&quot;(\\.|[^&quot;\\])*&quot;|&#39;(\\.|[^&#39;\\])*&#39;|.[^/&quot;&#39;\\]*)#defined $2 ? $2 : &quot;&quot;#gse</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/print.html">print</a><span class="sc">;</span></li></ol></pre><p>This could, of course, be more legibly written with the <code class="inline"><span class="q">/x</span></code>
 modifier, adding
whitespace and comments. Here it is expanded, courtesy of Fred Curtis.</p>
<pre class="verbatim"><ol><li>    <span class="q">s{</span></li><li>       <span class="q">       /\*         ##  Start of /* ... */ comment</span></li><li>       <span class="q">       [^*]*\*+    ##  Non-* followed by 1-or-more *&#39;s</span></li><li>       <span class="q">       (</span></li><li>         <span class="q">         [^/*][^*]*\*+</span></li><li>       <span class="q">       )*          ##  0-or-more things which don&#39;t start with /</span></li><li>                   <span class="q">                   ##    but do end with &#39;*&#39;</span></li><li>       <span class="q">       /           ##  End of /* ... */ comment</span></li><li></li><li>     <span class="q">     |         ##     OR  various things which aren&#39;t comments:</span></li><li></li><li>       <span class="q">       (</span></li><li>         <span class="q">         &quot;           ##  Start of &quot; ... &quot; string</span></li><li>         <span class="q">         (</span></li><li>           <span class="q">           \\.           ##  Escaped char</span></li><li>         <span class="q">         |               ##    OR</span></li><li>           <span class="q">           [^&quot;\\]        ##  Non &quot;\</span></li><li>         <span class="q">         )*</span></li><li>         <span class="q">         &quot;           ##  End of &quot; ... &quot; string</span></li><li></li><li>       <span class="q">       |         ##     OR</span></li><li></li><li>         <span class="q">         &#39;           ##  Start of &#39; ... &#39; string</span></li><li>         <span class="q">         (</span></li><li>           <span class="q">           \\.           ##  Escaped char</span></li><li>         <span class="q">         |               ##    OR</span></li><li>           <span class="q">           [^&#39;\\]        ##  Non &#39;\</span></li><li>         <span class="q">         )*</span></li><li>         <span class="q">         &#39;           ##  End of &#39; ... &#39; string</span></li><li></li><li>       <span class="q">       |         ##     OR</span></li><li></li><li>         <span class="q">         .           ##  Anything other char</span></li><li>         <span class="q">         [^/&quot;&#39;\\]*   ##  Chars which doesn&#39;t start a comment, string or escape</span></li><li>       <span class="q">       )</span></li><li>     <span class="q">     }{defined $2 ? $2 : &quot;&quot;}gxse</span><span class="sc">;</span></li></ol></pre><p>A slight modification also removes C++ comments, possibly spanning multiple lines
using a continuation character:</p>
<pre class="verbatim"><ol><li> <span class="q">s#/\*[^*]*\*+([^/*][^*]*\*+)*/|//([^\\]|[^\n][\n]?)*?\n|(&quot;(\\.|[^&quot;\\])*&quot;|&#39;(\\.|[^&#39;\\])*&#39;|.[^/&quot;&#39;\\]*)#defined $3 ? $3 : &quot;&quot;#gse</span><span class="sc">;</span></li></ol></pre><a class='view-head2' id="Can-I-use-Perl-regular-expressions-to-match-balanced-text%3f"></a><h3 class='h3' >Can I use Perl regular expressions to match balanced text?
 
  
   </h3>
<p>(contributed by brian d foy)</p>
<p>Your first try should probably be the <a href="Text/Balanced.html">Text::Balanced</a> module, which
is in the Perl standard library since Perl 5.8. It has a variety of
functions to deal with tricky text. The <a href="https://search.cpan.org/perldoc/Regexp::Common">Regexp::Common</a> module can
also help by providing canned patterns you can use.</p>
<p>As of Perl 5.10, you can match balanced text with regular expressions
using recursive patterns. Before Perl 5.10, you had to resort to
various tricks such as using Perl code in <code class="inline"><span class="s">(</span><span class="q">??</span><span class="s">{</span><span class="s">}</span><span class="s">)</span></code>
 sequences.</p>
<p>Here's an example using a recursive regular expression. The goal is to
capture all of the text within angle brackets, including the text in
nested angle brackets. This sample text has two "major" groups: a
group with one level of nesting and a group with two levels of
nesting. There are five total groups in angle brackets:</p>
<pre class="verbatim"><ol><li>    <span class="w">I</span> <span class="w">have</span> <span class="w">some</span> &lt;<span class="w">brackets</span> <span class="w">in</span> <span class="q">&lt;nested brackets&gt;</span> &gt; <a class="l_k" href="functions/and.html">and</a></li><li>    <span class="q">&lt;another group &lt;nested once &lt;nested twice&gt;</span> &gt; &gt;</li><li>    <a class="l_k" href="functions/and.html">and</a> <span class="w">that&#39;s</span> <span class="w">it</span>.</li></ol></pre><p>The regular expression to match the balanced text uses two new (to
Perl 5.10) regular expression features. These are covered in <a href="perlre.html">perlre</a>
and this example is a modified version of one in that documentation.</p>
<p>First, adding the new possessive <code class="inline">+</code>
 to any quantifier finds the
longest match and does not backtrack. That's important since you want
to handle any angle brackets through the recursion, not backtracking.
The group <code class="inline"><span class="s">[</span>^&lt;&gt;<span class="s">]</span>++</code>
 finds one or more non-angle brackets without
backtracking.</p>
<p>Second, the new <code class="inline"><span class="s">(</span><span class="q">?PARNO)</span></code>
 refers to the sub-pattern in the
particular capture group given by <code class="inline"><span class="w">PARNO</span></code>
. In the following regex,
the first capture group finds (and remembers) the balanced text, and
you need that same pattern within the first buffer to get past the
nested text. That's the recursive part. The <code class="inline"><span class="s">(</span><span class="q">?1)</span></code>
 uses the pattern
in the outer capture group as an independent part of the regex.</p>
<p>Putting it all together, you have:</p>
<pre class="verbatim"><ol><li>    <span class="c">#!/usr/local/bin/perl5.10.0</span></li><li></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$string</span> =<span class="h">&lt;&lt;&quot;HERE&quot;</span><span class="sc">;</span></li><li><span class="hh">    I have some &lt;brackets in &lt;nested brackets&gt; &gt; and</span></li><li><span class="hh">    &lt;another group &lt;nested once &lt;nested twice&gt; &gt; &gt;</span></li><li><span class="hh">    and that&#39;s it.</span></li><li><span class="hh">    HERE</span></li><li></li><li><span class="hh">    my @groups = $string =~ m/</span></li><li><span class="hh">            (                   # start of capture group 1</span></li><li><span class="hh">            &lt;                   # match an opening angle bracket</span></li><li><span class="hh">                (?:</span></li><li><span class="hh">                    [^&lt;&gt;]++     # one or more non angle brackets, non backtracking</span></li><li><span class="hh">                      |</span></li><li><span class="hh">                    (?1)        # found &lt; or &gt;, so recurse to capture group 1</span></li><li><span class="hh">                )*</span></li><li><span class="hh">            &gt;                   # match a closing angle bracket</span></li><li><span class="hh">            )                   # end of capture group 1</span></li><li><span class="hh">            /xg;</span></li><li></li><li><span class="hh">    $&quot; = &quot;\n\t&quot;;</span></li><li><span class="hh">    print &quot;Found:\n\t@groups\n&quot;;</span></li></ol></pre><p>The output shows that Perl found the two major groups:</p>
<pre class="verbatim"><ol><li>    <span class="j">Found:</span></li><li>        <span class="q">&lt;brackets in &lt;nested brackets&gt;</span> &gt;</li><li>        <span class="q">&lt;another group &lt;nested once &lt;nested twice&gt;</span> &gt; &gt;</li></ol></pre><p>With a little extra work, you can get the all of the groups in angle
brackets even if they are in other angle brackets too. Each time you
get a balanced match, remove its outer delimiter (that's the one you
just matched so don't match it again) and add it to a queue of strings
to process. Keep doing that until you get no matches:</p>
<pre class="verbatim"><ol><li>    <span class="c">#!/usr/local/bin/perl5.10.0</span></li><li></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@queue</span> =<span class="h">&lt;&lt;&quot;HERE&quot;</span><span class="sc">;</span></li><li><span class="hh">    I have some &lt;brackets in &lt;nested brackets&gt; &gt; and</span></li><li><span class="hh">    &lt;another group &lt;nested once &lt;nested twice&gt; &gt; &gt;</span></li><li><span class="hh">    and that&#39;s it.</span></li><li><span class="hh">    HERE</span></li><li></li><li><span class="hh">    my $regex = qr/</span></li><li><span class="hh">            (                   # start of bracket 1</span></li><li><span class="hh">            &lt;                   # match an opening angle bracket</span></li><li><span class="hh">                (?:</span></li><li><span class="hh">                    [^&lt;&gt;]++     # one or more non angle brackets, non backtracking</span></li><li><span class="hh">                      |</span></li><li><span class="hh">                    (?1)        # recurse to bracket 1</span></li><li><span class="hh">                )*</span></li><li><span class="hh">            &gt;                   # match a closing angle bracket</span></li><li><span class="hh">            )                   # end of bracket 1</span></li><li><span class="hh">            /x;</span></li><li></li><li><span class="hh">    $&quot; = &quot;\n\t&quot;;</span></li><li></li><li><span class="hh">    while( @queue ) {</span></li><li><span class="hh">        my $string = shift @queue;</span></li><li></li><li><span class="hh">        my @groups = $string =~ m/$regex/g;</span></li><li><span class="hh">        print &quot;Found:\n\t@groups\n\n&quot; if @groups;</span></li><li></li><li><span class="hh">        unshift @queue, map { s/^&lt;//; s/&gt;$//; $_ } @groups;</span></li><li><span class="hh">    }</span></li></ol></pre><p>The output shows all of the groups. The outermost matches show up
first and the nested matches so up later:</p>
<pre class="verbatim"><ol><li>    <span class="j">Found:</span></li><li>        <span class="q">&lt;brackets in &lt;nested brackets&gt;</span> &gt;</li><li>        <span class="q">&lt;another group &lt;nested once &lt;nested twice&gt;</span> &gt; &gt;</li><li></li><li>    <span class="w">Found</span><span class="co">:</span></li><li>        <span class="q">&lt;nested brackets&gt;</span></li><li></li><li>    <span class="w">Found</span><span class="co">:</span></li><li>        <span class="q">&lt;nested once &lt;nested twice&gt;</span> &gt;</li><li></li><li>    <span class="w">Found</span><span class="co">:</span></li><li>        <span class="q">&lt;nested twice&gt;</span></li></ol></pre><a class='view-head2' id="What-does-it-mean-that-regexes-are-greedy%3f-How-can-I-get-around-it%3f"></a><h3 class='h3' >What does it mean that regexes are greedy? How can I get around it?
 </h3>
<p>Most people mean that greedy regexes match as much as they can.
Technically speaking, it's actually the quantifiers (<code class="inline"><span class="q">?</span></code>
, <code class="inline"><span class="i">*</span></code>
, <code class="inline">+</code>
,
<code class="inline"><span class="s">{</span><span class="s">}</span></code>
) that are greedy rather than the whole pattern; Perl prefers local
greed and immediate gratification to overall greed. To get non-greedy
versions of the same quantifiers, use (<code class="inline"><span class="q">??</span></code>
, <code class="inline"><span class="i">*?</span></code>
, <code class="inline">+<span class="q">?</span></code>
, <code class="inline"><span class="s">{</span><span class="s">}</span><span class="q">?</span></code>
).</p>
<p>An example:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$s1</span> = <a class="l_k" href="functions/my.html">my</a> <span class="i">$s2</span> = <span class="q">&quot;I am very very cold&quot;</span><span class="sc">;</span></li><li>    <span class="i">$s1</span> =~ <span class="q">s/ve.*y //</span><span class="sc">;</span>      <span class="c"># I am cold</span></li><li>    <span class="i">$s2</span> =~ <span class="q">s/ve.*?y //</span><span class="sc">;</span>     <span class="c"># I am very cold</span></li></ol></pre><p>Notice how the second substitution stopped matching as soon as it
encountered "y ". The <code class="inline"><span class="i">*?</span></code>
 quantifier effectively tells the regular
expression engine to find a match as quickly as possible and pass
control on to whatever is next in line, as you would if you were
playing hot potato.</p>
<a class='view-head2' id="How-do-I-process-each-word-on-each-line%3f"></a><h3 class='h3' >How do I process each word on each line?
</h3>
<p>Use the split function:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/foreach.html">foreach</a> <a class="l_k" href="functions/my.html">my</a> <span class="i">$word</span> <span class="s">(</span> <a class="l_k" href="functions/split.html">split</a> <span class="s">)</span> <span class="s">{</span></li><li>            <span class="c"># do something with $word here</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>Note that this isn't really a word in the English sense; it's just
chunks of consecutive non-whitespace characters.</p>
<p>To work with only alphanumeric sequences (including underscores), you
might consider</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/foreach.html">foreach</a> <span class="i">$word</span> <span class="s">(</span><span class="q">m/(\w+)/g</span><span class="s">)</span> <span class="s">{</span></li><li>            <span class="c"># do something with $word here</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head2' id="How-can-I-print-out-a-word-frequency-or-line-frequency-summary%3f"></a><h3 class='h3' >How can I print out a word-frequency or line-frequency summary?</h3>
<p>To do this, you have to parse out each word in the input stream. We'll
pretend that by word you mean chunk of alphabetics, hyphens, or
apostrophes, rather than the non-whitespace chunk idea of a word given
in the previous question:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">%seen</span><span class="s">)</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <span class="q">/(\b[^\W_\d][\w&#39;-]+\b)/g</span> <span class="s">)</span> <span class="s">{</span>   <span class="c"># misses &quot;`sheep&#39;&quot;</span></li><li>            <span class="i">$seen</span>{<span class="i">$1</span>}++<span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li><li></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$word</span><span class="cm">,</span> <span class="i">$count</span><span class="s">)</span> = <a class="l_k" href="functions/each.html">each</a> <span class="i">%seen</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$count $word\n&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>If you wanted to do the same thing for lines, you wouldn't need a
regular expression:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">%seen</span><span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <span class="i">$seen</span>{<span class="i">$_</span>}++<span class="sc">;</span></li><li>    <span class="s">}</span></li><li></li><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$line</span><span class="cm">,</span> <span class="i">$count</span><span class="s">)</span> = <a class="l_k" href="functions/each.html">each</a> <span class="i">%seen</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$count $line&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>If you want these output in a sorted order, see <a href="perlfaq4.html">perlfaq4</a>: "How do I
sort a hash (optionally by value instead of key)?".</p>
<a class='view-head2' id="How-can-I-do-approximate-matching%3f"></a><h3 class='h3' >How can I do approximate matching?
 </h3>
<p>See the module <a href="https://search.cpan.org/perldoc/String::Approx">String::Approx</a> available from CPAN.</p>
<a class='view-head2' id="How-do-I-efficiently-match-many-regular-expressions-at-once%3f"></a><h3 class='h3' >How do I efficiently match many regular expressions at once?
 
</h3>
<p>(contributed by brian d foy)</p>
<p>If you have Perl 5.10 or later, this is almost trivial. You just smart
match against an array of regular expression objects:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@patterns</span> = <span class="s">(</span> <span class="q">qr/Fr.d/</span><span class="cm">,</span> <span class="q">qr/B.rn.y/</span><span class="cm">,</span> <span class="q">qr/W.lm./</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="i">$string</span> ~~ <span class="i">@patterns</span> <span class="s">)</span> <span class="s">{</span></li><li>        ...</li><li>    <span class="s">}</span><span class="sc">;</span></li></ol></pre><p>The smart match stops when it finds a match, so it doesn't have to try
every expression.</p>
<p>Earlier than Perl 5.10, you have a bit of work to do. You want to
avoid compiling a regular expression every time you want to match it.
In this example, perl must recompile the regular expression for every
iteration of the <code class="inline"><a class="l_k" href="functions/foreach.html">foreach</a></code> loop since it has no way to know what
<code class="inline"><span class="i">$pattern</span></code>
 will be:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@patterns</span> = <span class="q">qw( foo bar baz )</span><span class="sc">;</span></li><li></li><li>    <span class="j">LINE:</span> <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <span class="q">&lt;DATA&gt;</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/foreach.html">foreach</a> <span class="i">$pattern</span> <span class="s">(</span> <span class="i">@patterns</span> <span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="q">/\b$pattern\b/i</span> <span class="s">)</span> <span class="s">{</span></li><li>                <a class="l_k" href="functions/print.html">print</a><span class="sc">;</span></li><li>                <a class="l_k" href="functions/next.html">next</a> <span class="j">LINE</span><span class="sc">;</span></li><li>            <span class="s">}</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>The <code class="inline"><a class="l_k" href="functions/qr.html">qr//</a></code> operator showed up in perl 5.005. It compiles a regular
expression, but doesn't apply it. When you use the pre-compiled
version of the regex, perl does less work. In this example, I inserted
a <code class="inline"><a class="l_k" href="functions/map.html">map</a></code> to turn each pattern into its pre-compiled form. The rest of
the script is the same, but faster:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@patterns</span> = <a class="l_k" href="functions/map.html">map</a> <span class="s">{</span> <span class="q">qr/\b$_\b/i</span> <span class="s">}</span> <span class="q">qw( foo bar baz )</span><span class="sc">;</span></li><li></li><li>    <span class="j">LINE:</span> <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/foreach.html">foreach</a> <span class="i">$pattern</span> <span class="s">(</span> <span class="i">@patterns</span> <span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="q">/$pattern/</span> <span class="s">)</span> <span class="s">{</span></li><li>                <a class="l_k" href="functions/print.html">print</a><span class="sc">;</span></li><li>                <a class="l_k" href="functions/next.html">next</a> <span class="j">LINE</span><span class="sc">;</span></li><li>            <span class="s">}</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>In some cases, you may be able to make several patterns into a single
regular expression. Beware of situations that require backtracking
though.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <a class="l_k" href="functions/join.html">join</a> <span class="q">&#39;|&#39;</span><span class="cm">,</span> <span class="q">qw( foo bar baz )</span><span class="sc">;</span></li><li></li><li>    <span class="j">LINE:</span> <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> &lt;&gt; <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/if.html">if</a> <span class="q">/\b(?:$regex)\b/i</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>For more details on regular expression efficiency, see <i>Mastering
Regular Expressions</i> by Jeffrey Friedl. He explains how the regular
expressions engine works and why some patterns are surprisingly
inefficient. Once you understand how perl applies regular expressions,
you can tune them for individual situations.</p>
<a class='view-head2' id="Why-don't-word-boundary-searches-with-%5cb-work-for-me%3f"></a><h3 class='h3' >Why don't word-boundary searches with <code class="inline">\<span class="w">b</span></code>
 work for me?
</h3>
<p>(contributed by brian d foy)</p>
<p>Ensure that you know what \b really does: it's the boundary between a
word character, \w, and something that isn't a word character. That
thing that isn't a word character might be \W, but it can also be the
start or end of the string.</p>
<p>It's not (not!) the boundary between whitespace and non-whitespace,
and it's not the stuff between words we use to create sentences.</p>
<p>In regex speak, a word boundary (\b) is a "zero width assertion",
meaning that it doesn't represent a character in the string, but a
condition at a certain position.</p>
<p>For the regular expression, /\bPerl\b/, there has to be a word
boundary before the "P" and after the "l". As long as something other
than a word character precedes the "P" and succeeds the "l", the
pattern will match. These strings match /\bPerl\b/.</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;Perl&quot;</span>    <span class="c"># no word char before P or after l</span></li><li>    <span class="q">&quot;Perl &quot;</span>   <span class="c"># same as previous (space is not a word char)</span></li><li>    <span class="q">&quot;&#39;Perl&#39;&quot;</span>  <span class="c"># the &#39; char is not a word char</span></li><li>    <span class="q">&quot;Perl&#39;s&quot;</span>  <span class="c"># no word char before P, non-word char after &quot;l&quot;</span></li></ol></pre><p>These strings do not match /\bPerl\b/.</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;Perl_&quot;</span>   <span class="c"># _ is a word char!</span></li><li>    <span class="q">&quot;Perler&quot;</span>  <span class="c"># no word char before P, but one after l</span></li></ol></pre><p>You don't have to use \b to match words though. You can look for
non-word characters surrounded by word characters. These strings
match the pattern /\b'\b/.</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;don&#39;t&quot;</span>   <span class="c"># the &#39; char is surrounded by &quot;n&quot; and &quot;t&quot;</span></li><li>    <span class="q">&quot;qep&#39;a&#39;&quot;</span>  <span class="c"># the &#39; char is surrounded by &quot;p&quot; and &quot;a&quot;</span></li></ol></pre><p>These strings do not match /\b'\b/.</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;foo&#39;&quot;</span>    <span class="c"># there is no word char after non-word &#39;</span></li></ol></pre><p>You can also use the complement of \b, \B, to specify that there
should not be a word boundary.</p>
<p>In the pattern /\Bam\B/, there must be a word character before the "a"
and after the "m". These patterns match /\Bam\B/:</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;llama&quot;</span>   <span class="c"># &quot;am&quot; surrounded by word chars</span></li><li>    <span class="q">&quot;Samuel&quot;</span>  <span class="c"># same</span></li></ol></pre><p>These strings do not match /\Bam\B/</p>
<pre class="verbatim"><ol><li>    <span class="q">&quot;Sam&quot;</span>      <span class="c"># no word boundary before &quot;a&quot;, but one after &quot;m&quot;</span></li><li>    <span class="q">&quot;I am Sam&quot;</span> <span class="c"># &quot;am&quot; surrounded by non-word chars</span></li></ol></pre><a class='view-head2' id="Why-does-using-%24%26%2c-%24%60%2c-or-%24'-slow-my-program-down%3f"></a><h3 class='h3' >Why does using $&amp;, $`, or $' slow my program down?
     </h3>
<p>(contributed by Anno Siegel)</p>
<p>Once Perl sees that you need one of these variables anywhere in the
program, it provides them on each and every pattern match. That means
that on every pattern match the entire string will be copied, part of it
to $`, part to $&amp;, and part to $'. Thus the penalty is most severe with
long strings and patterns that match often. Avoid $&amp;, $', and $` if you
can, but if you can't, once you've used them at all, use them at will
because you've already paid the price. Remember that some algorithms
really appreciate them. As of the 5.005 release, the $&amp; variable is no
longer "expensive" the way the other two are.</p>
<p>Since Perl 5.6.1 the special variables @- and @+ can functionally replace
$`, $&amp; and $'. These arrays contain pointers to the beginning and end
of each match (see perlvar for the full story), so they give you
essentially the same information, but without the risk of excessive
string copying.</p>
<p>Perl 5.10 added three specials, <code class="inline"><span class="i">$</span>{<span class="w">^MATCH</span>}</code>
, <code class="inline"><span class="i">$</span>{<span class="w">^PREMATCH</span>}</code>
, and
<code class="inline"><span class="i">$</span>{<span class="w">^POSTMATCH</span>}</code>
 to do the same job but without the global performance
penalty. Perl 5.10 only sets these variables if you compile or execute the
regular expression with the <code class="inline"><span class="q">/p</span></code>
 modifier.</p>
<a class='view-head2' id="What-good-is-%5cG-in-a-regular-expression%3f"></a><h3 class='h3' >What good is <code class="inline">\<span class="w">G</span></code>
 in a regular expression?
</h3>
<p>You use the <code class="inline">\<span class="w">G</span></code>
 anchor to start the next match on the same
string where the last match left off. The regular
expression engine cannot skip over any characters to find
the next match with this anchor, so <code class="inline">\<span class="w">G</span></code>
 is similar to the
beginning of string anchor, <code class="inline">^</code>
. The <code class="inline">\<span class="w">G</span></code>
 anchor is typically
used with the <code class="inline"><span class="w">g</span></code>
 flag. It uses the value of <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code>
as the position to start the next match. As the match
operator makes successive matches, it updates <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code> with the
position of the next character past the last match (or the
first character of the next match, depending on how you like
to look at it). Each string has its own <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code> value.</p>
<p>Suppose you want to match all of consecutive pairs of digits
in a string like "1122a44" and stop matching when you
encounter non-digits. You want to match <code class="inline"><span class="n">11</span></code>
 and <code class="inline"><span class="n">22</span></code>
 but
the letter &lt;a&gt; shows up between <code class="inline"><span class="n">22</span></code>
 and <code class="inline"><span class="n">44</span></code>
 and you want
to stop at <code class="inline"><span class="w">a</span></code>
. Simply matching pairs of digits skips over
the <code class="inline"><span class="w">a</span></code>
 and still matches <code class="inline"><span class="n">44</span></code>
.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span> = <span class="q">&quot;1122a44&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@pairs</span> = <span class="q">m/(\d\d)/g</span><span class="sc">;</span>   <span class="c"># qw( 11 22 44 )</span></li></ol></pre><p>If you use the <code class="inline">\<span class="w">G</span></code>
 anchor, you force the match after <code class="inline"><span class="n">22</span></code>
 to
start with the <code class="inline"><span class="w">a</span></code>
. The regular expression cannot match
there since it does not find a digit, so the next match
fails and the match operator returns the pairs it already
found.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span> = <span class="q">&quot;1122a44&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@pairs</span> = <span class="q">m/\G(\d\d)/g</span><span class="sc">;</span> <span class="c"># qw( 11 22 )</span></li></ol></pre><p>You can also use the <code class="inline">\<span class="w">G</span></code>
 anchor in scalar context. You
still need the <code class="inline"><span class="w">g</span></code>
 flag.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span> = <span class="q">&quot;1122a44&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <span class="q">m/\G(\d\d)/g</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Found $1\n&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>After the match fails at the letter <code class="inline"><span class="w">a</span></code>
, perl resets <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code>
and the next match on the same string starts at the beginning.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span> = <span class="q">&quot;1122a44&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <span class="q">m/\G(\d\d)/g</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Found $1\n&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Found $1 after while&quot;</span> <a class="l_k" href="functions/if.html">if</a> <span class="q">m/(\d\d)/g</span><span class="sc">;</span> <span class="c"># finds &quot;11&quot;</span></li></ol></pre><p>You can disable <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code> resets on fail with the <code class="inline"><span class="w">c</span></code>
 flag, documented
in <a href="perlop.html">perlop</a> and <a href="perlreref.html">perlreref</a>. Subsequent matches start where the last
successful match ended (the value of <code class="inline"><a class="l_k" href="functions/pos.html">pos()</a></code>) even if a match on the
same string has failed in the meantime. In this case, the match after
the <code class="inline"><a class="l_k" href="functions/while.html">while()</a></code> loop starts at the <code class="inline"><span class="w">a</span></code>
 (where the last match stopped),
and since it does not use any anchor it can skip over the <code class="inline"><span class="w">a</span></code>
 to find
<code class="inline"><span class="n">44</span></code>
.</p>
<pre class="verbatim"><ol><li>    <span class="i">$_</span> = <span class="q">&quot;1122a44&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/while.html">while</a><span class="s">(</span> <span class="q">m/\G(\d\d)/gc</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Found $1\n&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Found $1 after while&quot;</span> <a class="l_k" href="functions/if.html">if</a> <span class="q">m/(\d\d)/g</span><span class="sc">;</span> <span class="c"># finds &quot;44&quot;</span></li></ol></pre><p>Typically you use the <code class="inline">\<span class="w">G</span></code>
 anchor with the <code class="inline"><span class="w">c</span></code>
 flag
when you want to try a different match if one fails,
such as in a tokenizer. Jeffrey Friedl offers this example
which works in 5.004 or later.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span>&lt;&gt;<span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/chomp.html">chomp</a><span class="sc">;</span></li><li>        <span class="j">PARSER:</span> <span class="s">{</span></li><li>            <span class="q">m/ \G( \d+\b    )/gcx</span>   &amp;&amp; <a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;number: $1\n&quot;</span><span class="sc">;</span>  <a class="l_k" href="functions/redo.html">redo</a><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span></li><li>            <span class="q">m/ \G( \w+      )/gcx</span>   &amp;&amp; <a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;word:   $1\n&quot;</span><span class="sc">;</span>  <a class="l_k" href="functions/redo.html">redo</a><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span></li><li>            <span class="q">m/ \G( \s+      )/gcx</span>   &amp;&amp; <a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;space:  $1\n&quot;</span><span class="sc">;</span>  <a class="l_k" href="functions/redo.html">redo</a><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span></li><li>            <span class="q">m/ \G( [^\w\d]+ )/gcx</span>   &amp;&amp; <a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;other:  $1\n&quot;</span><span class="sc">;</span>  <a class="l_k" href="functions/redo.html">redo</a><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>For each line, the <code class="inline"><span class="w">PARSER</span></code>
 loop first tries to match a series
of digits followed by a word boundary. This match has to
start at the place the last match left off (or the beginning
of the string on the first match). Since <code class="inline"><span class="q">m/ \G( \d+\b</span>
<span class="q">)/gcx</span></code>
 uses the <code class="inline"><span class="w">c</span></code>
 flag, if the string does not match that
regular expression, perl does not reset pos() and the next
match starts at the same position to try a different
pattern.</p>
<a class='view-head2' id="Are-Perl-regexes-DFAs-or-NFAs%3f-Are-they-POSIX-compliant%3f"></a><h3 class='h3' >Are Perl regexes DFAs or NFAs? Are they POSIX compliant?
  </h3>
<p>While it's true that Perl's regular expressions resemble the DFAs
(deterministic finite automata) of the egrep(1) program, they are in
fact implemented as NFAs (non-deterministic finite automata) to allow
backtracking and backreferencing. And they aren't POSIX-style either,
because those guarantee worst-case behavior for all cases. (It seems
that some people prefer guarantees of consistency, even when what's
guaranteed is slowness.) See the book "Mastering Regular Expressions"
(from O'Reilly) by Jeffrey Friedl for all the details you could ever
hope to know on these matters (a full citation appears in
<a href="perlfaq2.html">perlfaq2</a>).</p>
<a class='view-head2' id="What's-wrong-with-using-grep-in-a-void-context%3f"></a><h3 class='h3' >What's wrong with using grep in a void context?
</h3>
<p>The problem is that grep builds a return list, regardless of the context.
This means you're making Perl go to the trouble of building a list that
you then just throw away. If the list is large, you waste both time and space.
If your intent is to iterate over the list, then use a for loop for this
purpose.</p>
<p>In perls older than 5.8.1, map suffers from this problem as well.
But since 5.8.1, this has been fixed, and map is context aware - in void
context, no lists are constructed.</p>
<a class='view-head2' id="How-can-I-match-strings-with-multibyte-characters%3f"></a><h3 class='h3' >How can I match strings with multibyte characters?
 
  </h3>
<p>Starting from Perl 5.6 Perl has had some level of multibyte character
support. Perl 5.8 or later is recommended. Supported multibyte
character repertoires include Unicode, and legacy encodings
through the Encode module. See <a href="perluniintro.html">perluniintro</a>, <a href="perlunicode.html">perlunicode</a>,
and <a href="Encode.html">Encode</a>.</p>
<p>If you are stuck with older Perls, you can do Unicode with the
<a href="https://search.cpan.org/perldoc/Unicode::String">Unicode::String</a> module, and character conversions using the
<a href="https://search.cpan.org/perldoc/Unicode::Map8">Unicode::Map8</a> and <a href="https://search.cpan.org/perldoc/Unicode::Map">Unicode::Map</a> modules. If you are using
Japanese encodings, you might try using the jperl 5.005_03.</p>
<p>Finally, the following set of approaches was offered by Jeffrey
Friedl, whose article in issue #5 of The Perl Journal talks about
this very matter.</p>
<p>Let's suppose you have some weird Martian encoding where pairs of
ASCII uppercase letters encode single Martian letters (i.e. the two
bytes "CV" make a single Martian letter, as do the two bytes "SG",
"VS", "XX", etc.). Other bytes represent single characters, just like
ASCII.</p>
<p>So, the string of Martian "I am CVSGXX!" uses 12 bytes to encode the
nine characters 'I', ' ', 'a', 'm', ' ', 'CV', 'SG', 'XX', '!'.</p>
<p>Now, say you want to search for the single character <code class="inline"><span class="q">/GX/</span></code>
. Perl
doesn't know about Martian, so it'll find the two bytes "GX" in the "I
am CVSGXX!" string, even though that character isn't there: it just
looks like it is because "SG" is next to "XX", but there's no real
"GX". This is a big problem.</p>
<p>Here are a few ways, all painful, to deal with it:</p>
<pre class="verbatim"><ol><li>    <span class="c"># Make sure adjacent &quot;martian&quot; bytes are no longer adjacent.</span></li><li>    <span class="i">$martian</span> =~ <span class="q">s/([A-Z][A-Z])/ $1 /g</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;found GX!\n&quot;</span> <a class="l_k" href="functions/if.html">if</a> <span class="i">$martian</span> =~ <span class="q">/GX/</span><span class="sc">;</span></li></ol></pre><p>Or like this:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">@chars</span> = <span class="i">$martian</span> =~ <span class="q">m/([A-Z][A-Z]|[^A-Z])/g</span><span class="sc">;</span></li><li>    <span class="c"># above is conceptually similar to:     my @chars = $text =~ m/(.)/g;</span></li><li>    <span class="c">#</span></li><li>    <a class="l_k" href="functions/foreach.html">foreach</a> <a class="l_k" href="functions/my.html">my</a> <span class="i">$char</span> <span class="s">(</span><span class="i">@chars</span><span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;found GX!\n&quot;</span><span class="cm">,</span> <a class="l_k" href="functions/last.html">last</a> <a class="l_k" href="functions/if.html">if</a> <span class="i">$char</span> <a class="l_k" href="functions/eq.html">eq</a> <span class="q">&#39;GX&#39;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>Or like this:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span><span class="i">$martian</span> =~ <span class="q">m/\G([A-Z][A-Z]|.)/gs</span><span class="s">)</span> <span class="s">{</span>  <span class="c"># \G probably unneeded</span></li><li>        <a class="l_k" href="functions/if.html">if</a> <span class="s">(</span><span class="i">$1</span> <a class="l_k" href="functions/eq.html">eq</a> <span class="q">&#39;GX&#39;</span><span class="s">)</span> <span class="s">{</span></li><li>            <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;found GX!\n&quot;</span><span class="sc">;</span></li><li>            <a class="l_k" href="functions/last.html">last</a><span class="sc">;</span></li><li>        <span class="s">}</span></li><li>    <span class="s">}</span></li></ol></pre><p>Here's another, slightly less painful, way to do it from Benjamin
Goldberg, who uses a zero-width negative look-behind assertion.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;found GX!\n&quot;</span> <a class="l_k" href="functions/if.html">if</a>    <span class="i">$martian</span> =~ <span class="q">m/</span></li><li>        <span class="q">        (?&lt;![A-Z])</span></li><li>        <span class="q">        (?:[A-Z][A-Z])*?</span></li><li>        <span class="q">        GX</span></li><li>        <span class="q">        /x</span><span class="sc">;</span></li></ol></pre><p>This succeeds if the "martian" character GX is in the string, and fails
otherwise. If you don't like using (?&lt;!), a zero-width negative
look-behind assertion, you can replace (?&lt;![A-Z]) with (?:^|[^A-Z]).</p>
<p>It does have the drawback of putting the wrong thing in $-[0] and $+[0],
but this usually can be worked around.</p>
<a class='view-head2' id="How-do-I-match-a-regular-expression-that's-in-a-variable%3f"></a><h3 class='h3' >How do I match a regular expression that's in a variable?
    
 </h3>
<p>(contributed by brian d foy)</p>
<p>We don't have to hard-code patterns into the match operator (or
anything else that works with regular expressions). We can put the
pattern in a variable for later use.</p>
<p>The match operator is a double quote context, so you can interpolate
your variable just like a double quoted string. In this case, you
read the regular expression as user input and store it in <code class="inline"><span class="i">$regex</span></code>
.
Once you have the pattern in <code class="inline"><span class="i">$regex</span></code>
, you use that variable in the
match operator.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/chomp.html">chomp</a><span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">&lt;STDIN&gt;</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="i">$string</span> =~ <span class="q">m/$regex/</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Any regular expression special characters in <code class="inline"><span class="i">$regex</span></code>
 are still
special, and the pattern still has to be valid or Perl will complain.
For instance, in this pattern there is an unpaired parenthesis.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">&quot;Unmatched ( paren&quot;</span><span class="sc">;</span></li><li></li><li>    <span class="q">&quot;Two parens to bind them all&quot;</span> =~ <span class="q">m/$regex/</span><span class="sc">;</span></li></ol></pre><p>When Perl compiles the regular expression, it treats the parenthesis
as the start of a memory match. When it doesn't find the closing
parenthesis, it complains:</p>
<pre class="verbatim"><ol><li>    <span class="w">Unmatched</span> <span class="s">(</span> <span class="w">in</span> <span class="w">regex</span><span class="sc">;</span> <span class="w">marked</span> <span class="w">by</span> &lt;-- <span class="w">HERE</span> <span class="w">in</span> <span class="q">m/Unmatched ( &lt;-- HERE  paren/</span> <span class="w">at</span> <span class="w">script</span> <span class="w">line</span> <span class="n">3.</span></li></ol></pre><p>You can get around this in several ways depending on our situation.
First, if you don't want any of the characters in the string to be
special, you can escape them with <code class="inline"><a class="l_k" href="functions/quotemeta.html">quotemeta</a></code> before you use the string.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/chomp.html">chomp</a><span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">&lt;STDIN&gt;</span> <span class="s">)</span><span class="sc">;</span></li><li>    <span class="i">$regex</span> = <a class="l_k" href="functions/quotemeta.html">quotemeta</a><span class="s">(</span> <span class="i">$regex</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="i">$string</span> =~ <span class="q">m/$regex/</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>You can also do this directly in the match operator using the <code class="inline">\<span class="w">Q</span></code>

and <code class="inline">\<span class="w">E</span></code>
 sequences. The <code class="inline">\<span class="w">Q</span></code>
 tells Perl where to start escaping
special characters, and the <code class="inline">\<span class="w">E</span></code>
 tells it where to stop (see <a href="perlop.html">perlop</a>
for more details).</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/chomp.html">chomp</a><span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">&lt;STDIN&gt;</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="i">$string</span> =~ <span class="q">m/\Q$regex\E/</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Alternately, you can use <code class="inline"><a class="l_k" href="functions/qr.html">qr//</a></code>, the regular expression quote operator (see
<a href="perlop.html">perlop</a> for more details). It quotes and perhaps compiles the pattern,
and you can apply regular expression flags to the pattern.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/chomp.html">chomp</a><span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="i">$input</span> = <span class="q">&lt;STDIN&gt;</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <span class="q">qr/$input/is</span><span class="sc">;</span></li><li></li><li>    <span class="i">$string</span> =~ <span class="q">m/$regex/</span>  <span class="c"># same as m/$input/is;</span></li></ol></pre><p>You might also want to trap any errors by wrapping an <code class="inline"><a class="l_k" href="functions/eval.html">eval</a></code> block
around the whole thing.</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/chomp.html">chomp</a><span class="s">(</span> <a class="l_k" href="functions/my.html">my</a> <span class="i">$input</span> = <span class="q">&lt;STDIN&gt;</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/eval.html">eval</a> <span class="s">{</span></li><li>        <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <span class="i">$string</span> =~ <span class="q">m/\Q$input\E/</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li><li>    <span class="s">}</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/warn.html">warn</a> <span class="i">$@</span> <a class="l_k" href="functions/if.html">if</a> <span class="i">$@</span><span class="sc">;</span></li></ol></pre><p>Or...</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$regex</span> = <a class="l_k" href="functions/eval.html">eval</a> <span class="s">{</span> <span class="q">qr/$input/is</span> <span class="s">}</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/if.html">if</a><span class="s">(</span> <a class="l_k" href="functions/defined.html">defined</a> <span class="i">$regex</span> <span class="s">)</span> <span class="s">{</span></li><li>        <span class="i">$string</span> =~ <span class="q">m/$regex/</span><span class="sc">;</span></li><li>    <span class="s">}</span></li><li>    <a class="l_k" href="functions/else.html">else</a> <span class="s">{</span></li><li>        <a class="l_k" href="functions/warn.html">warn</a> <span class="i">$@</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><a class='view-head1' id="AUTHOR-AND-COPYRIGHT"></a><h2 class='h2' >AUTHOR AND COPYRIGHT</h2>
<p>Copyright (c) 1997-2010 Tom Christiansen, Nathan Torkington, and
other authors as noted. All rights reserved.</p>
<p>This documentation is free; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>
<p>Irrespective of its distribution, all code examples in this file
are hereby placed into the public domain. You are permitted and
encouraged to use this code in your own programs for fun
or for profit as you see fit. A simple comment in the code giving
credit would be courteous but is not required.</p>




      <ul><li><a href="#NAME">NAME</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><ul><li><a href="#How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code%3f">How can I hope to use regular expressions without creating illegible and unmaintainable code?
 
 </a></li><li><a href="#I'm-having-trouble-matching-over-more-than-one-line.-What's-wrong%3f">I'm having trouble matching over more than one line. What's wrong?
  </a></li><li><a href="#How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines%3f">How can I pull out lines between two patterns that are themselves on different lines?
</a></li><li><a href="#How-do-I-match-XML%2c-HTML%2c-or-other-nasty%2c-ugly-things-with-a-regex%3f">How do I match XML, HTML, or other nasty, ugly things with a regex?
     
</a></li><li><a href="#I-put-a-regular-expression-into-%24%2f-but-it-didn't-work.-What's-wrong%3f">I put a regular expression into $/ but it didn't work. What's wrong?
 
</a></li><li><a href="#How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS%3f">How do I substitute case-insensitively on the LHS while preserving case on the RHS?
 
 </a></li><li><a href="#How-can-I-make-%5cw-match-national-character-sets%3f">How can I make \w match national character sets?
</a></li><li><a href="#How-can-I-match-a-locale-smart-version-of-%2f%5ba-zA-Z%5d%2f%3f">How can I match a locale-smart version of /[a-zA-Z]/?
</a></li><li><a href="#How-can-I-quote-a-variable-to-use-in-a-regex%3f">How can I quote a variable to use in a regex?
  </a></li><li><a href="#What-is-%2fo-really-for%3f">What is /o really for?
 </a></li><li><a href="#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file%3f">How do I use a regular expression to strip C-style comments from a file?</a></li><li><a href="#Can-I-use-Perl-regular-expressions-to-match-balanced-text%3f">Can I use Perl regular expressions to match balanced text?
 
  
   </a></li><li><a href="#What-does-it-mean-that-regexes-are-greedy%3f-How-can-I-get-around-it%3f">What does it mean that regexes are greedy? How can I get around it?
 </a></li><li><a href="#How-do-I-process-each-word-on-each-line%3f">How do I process each word on each line?
</a></li><li><a href="#How-can-I-print-out-a-word-frequency-or-line-frequency-summary%3f">How can I print out a word-frequency or line-frequency summary?</a></li><li><a href="#How-can-I-do-approximate-matching%3f">How can I do approximate matching?
 </a></li><li><a href="#How-do-I-efficiently-match-many-regular-expressions-at-once%3f">How do I efficiently match many regular expressions at once?
 
</a></li><li><a href="#Why-don't-word-boundary-searches-with-%5cb-work-for-me%3f">Why don't word-boundary searches with \b work for me?
</a></li><li><a href="#Why-does-using-%24%26%2c-%24%60%2c-or-%24'-slow-my-program-down%3f">Why does using $&, $`, or $' slow my program down?
     </a></li><li><a href="#What-good-is-%5cG-in-a-regular-expression%3f">What good is \G in a regular expression?
</a></li><li><a href="#Are-Perl-regexes-DFAs-or-NFAs%3f-Are-they-POSIX-compliant%3f">Are Perl regexes DFAs or NFAs? Are they POSIX compliant?
  </a></li><li><a href="#What's-wrong-with-using-grep-in-a-void-context%3f">What's wrong with using grep in a void context?
</a></li><li><a href="#How-can-I-match-strings-with-multibyte-characters%3f">How can I match strings with multibyte characters?
 
  </a></li><li><a href="#How-do-I-match-a-regular-expression-that's-in-a-variable%3f">How do I match a regular expression that's in a variable?
    
 </a></li></ul><li><a href="#AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</a></li></ul>


                  </div>
                </article>
              </div>
            </div>
          </main>
        </div>
           <footer class="footer row bg-light pt-5 pb-5">
       <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
           <div class="row">
               <div class="col-md-4">
                   <ul class="list-unstyled">
                       <li>
                           <h4>Site info</h4>
                       </li>
                       <li>Docs mantained by
                           <a href="//lists.perl.org/list/perl5-porters.html"
                               rel="noopener">Perl 5 Porters</a>
                       </li>
                       <li>Perldoc site development sponsored by
                           <a href="//opusvl.com" rel="noopener">
                           <img style="margin: 20px 20px 5px 10px" class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo">
                        </a>
                    <li><span class="about_perldoc"><a href="//about.html">About PerlDOC</a></span>
                    </li>
                       </li>
                   </ul>
               </div>
               <div class="col-md-8">
                   <div class="row">
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Manuals</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-overview.html">Overview</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-tutorials.html">Tutorials</a>
                               </li>
                               <li>
                                   <a href="/5.20.2/index-faq.html">FAQs</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-history.html">Changes</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Reference</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-language.html">Language</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-functions.html">Functions</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/perlop.html">Operators</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/perlvar.html">Variables</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Modules</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-modules-A.html">Modules</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-pragmas.html">Pragmas</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-utilities.html">Utilities</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Misc</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-licence.html">License</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-internals.html">Internals</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.20.2/index-platforms.html">Platforms</a>
                               </li>
                            <li>
                                <a
                                    href="/5.20.2/index-about.html">About</a>
                            </li>
                           </ul>
                       </div>
                   </div>
               </div>
               <div class=" col-12 footer-inf text-center">
                   <small>perldoc.perl.org - Official documentation for the Perl
                       programming language</small>
               </div>
           </div>
       </div>
   </footer>

        	<div class="beta-wrapper beta-bottom-right ">
		<div class="beta beta-blue  ">
			<a class="beta-link "
				href="//github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
				<span class="beta-text">
					This website is a Beta release.
				</span>
				<span class="beta-text">
					For any issues please raise a ticket on GitHub
				</span>
			</a>
		</div>
	</div>

        <script src="/public/js/main.min.js"></script>
      </body>

      </html>
